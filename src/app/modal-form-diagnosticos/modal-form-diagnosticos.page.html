<ion-header>
  <ion-toolbar>
    <ion-title>
      Crear Diagnóstico
    </ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="cerrar_modal()">
        <ion-icon slot="icon-only" name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <form #diagnosticoForm="ngForm" (ngSubmit)="crear_diagnostico()">
    <ion-item>
      <ion-label position="stacked">Descripción del diagnóstico</ion-label>
      <ion-textarea [(ngModel)]="ct_descripcion_diagnostico" name="descripcion" rows="4" required></ion-textarea>
    </ion-item>
    <div *ngIf="diagnosticoForm.submitted && !diagnosticoForm.controls['descripcion'].valid" class="error-message">
      La descripción del diagnóstico es requerida.
    </div>

    <ion-item>
      <ion-label position="stacked">Tiempo estimado de solución (Horas)</ion-label>
      <ion-input type="number" [(ngModel)]="cn_tiempo_estimado_solucion" name="tiempo" required></ion-input>
    </ion-item>
    <div *ngIf="diagnosticoForm.submitted && !diagnosticoForm.controls['tiempo'].valid" class="error-message">
      El tiempo estimado de solución es requerido.
    </div>

    <ion-item>
      <ion-label position="stacked">Observaciones</ion-label>
      <ion-textarea [(ngModel)]="ct_observaciones" name="observaciones" rows="4" required></ion-textarea>
    </ion-item>
    <div *ngIf="diagnosticoForm.submitted && !diagnosticoForm.controls['observaciones'].valid" class="error-message">
      Las observaciones son requeridas.
    </div>

    <ion-item class="d-block">
      <ion-label class="mb-2">Seleccione una imagen</ion-label>
      <div class="d-flex align-items-center">
        <label class="btn btn-warning mr-2" for="fileInput">Seleccionar archivo</label>
        <span id="fileName"></span>
        <input type="file" id="fileInput" class="form-control-file" (change)="onFileChange($event)" required hidden>
      </div>
    </ion-item>
    <div *ngIf="diagnosticoForm.submitted && !img" class="error-message">
      La imagen es requerida.
    </div>

    <ion-button expand="block" type="submit" [disabled]="!diagnosticoForm.valid || !img">Crear Diagnóstico</ion-button>
  </form>

  <ion-toast [isOpen]="showToast" message="Se ha creado con éxito" duration="2000" color="success"></ion-toast>
</ion-content>
